<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ВУАП-1 — Пункты 02–14</title>

  <style>
    :root{
      --bg1:#0b1a2a; --bg2:#153a5a;
      --card:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.18);
      --text:#e9f2ff; --muted:#b7c7dd;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(255,255,255,.12), transparent 60%),
        radial-gradient(800px 500px at 85% 20%, rgba(255,255,255,.10), transparent 60%),
        linear-gradient(180deg,var(--bg1),var(--bg2));
    }
    .wrap{max-width:1300px;margin:0 auto;padding:18px 14px 30px}
    .card{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:14px;
      backdrop-filter:blur(6px);
      box-shadow:0 18px 40px rgba(0,0,0,.25);
    }
    h1{margin:0 0 6px;font-size:18px}
    .p{margin:0;color:var(--muted);font-size:13px;line-height:1.35}

    .hub{margin-top:12px;display:grid;grid-template-columns:380px 1fr;gap:12px}
    .menu{
      border:1px solid var(--stroke);
      border-radius:16px;
      padding:10px;
      background:rgba(0,0,0,.18);
      max-height:78vh; overflow:auto;
    }
    .item{
      display:flex; gap:10px; align-items:flex-start;
      padding:12px; border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      cursor:pointer; user-select:none;
      margin-bottom:10px;
    }
    .item:hover{background:rgba(255,255,255,.10)}
    .item.active{background:rgba(255,255,255,.14);border-color:rgba(255,255,255,.28)}
    .num{
      min-width:44px; display:inline-flex; justify-content:center; align-items:center;
      padding:6px 10px; border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.22);
      font-weight:900;
    }
    .ttl{font-size:14px;font-weight:800;line-height:1.15}
    .sub{font-size:12px;color:var(--muted);margin-top:4px;word-break:break-word}

    .viewer{
      border:1px solid var(--stroke);
      border-radius:16px;
      padding:10px;
      background:rgba(0,0,0,.12);
    }
    .top{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:6px 6px 10px;flex-wrap:wrap}
    .title{font-weight:900;font-size:14px}
    .btn{
      padding:8px 10px;border-radius:12px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.10);
      color:var(--text);
      text-decoration:none;
      font-size:12px;font-weight:800;
      cursor:pointer;
    }
    .btn:hover{background:rgba(255,255,255,.16)}
    iframe{
      width:100%; height:74vh;
      border:1px solid rgba(255,255,255,.18);
      border-radius:14px;
      background:rgba(0,0,0,.25);
    }
    .warn{
      margin-top:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px dashed rgba(255,255,255,.25);
      background:rgba(0,0,0,.18);
      color:var(--muted);
      font-size:12px;
      line-height:1.35;
    }

    @media(max-width:980px){
      .hub{grid-template-columns:1fr}
      iframe{height:70vh}
    }
  </style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <h1>ВУАП-1 · Пункты 02–14</h1>
    <p class="p">Нажми пункт слева — откроется справа внутри этой же страницы. Путь нормальный: <b>/vuap1/p02.html … /vuap1/p14.html</b>.</p>

    <div class="hub">
      <div class="menu" id="menu"></div>

      <div class="viewer">
        <div class="top">
          <div class="title" id="title">Выбери пункт</div>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <a class="btn" id="openNew" href="#" target="_blank" rel="noopener">Открыть отдельно</a>
            <button class="btn" type="button" onclick="reloadFrame()">Обновить</button>
          </div>
        </div>

        <iframe id="frame" src=""></iframe>

        <div class="warn" id="warn">
          Подсказка: если 404 — значит файла реально нет по пути <b>/vuap1/pXX.html</b>, или он назван иначе (регистр важен).
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // 1) Папка, где лежат все p02..p14.html
  const BASE = './vuap1/';

  // 2) Названия пунктов (не просто цифры)
  const items = [
    {id:'02', title:'Проверка передаточного числа по углу (направление)'},
    {id:'03', title:'Проверка передаточного числа по углу (крен)'},
    {id:'04', title:'Проверка крутизны сигнала (ОС)'},
    {id:'05', title:'Проверка передаточного числа по углу (тангаж)'},
    {id:'06', title:'Проверка передаточного числа по углу (высота)'},
    {id:'07', title:'Проверка работоспособности (по технологии)'},
    {id:'08', title:'Передаточное число по угловой скорости — направление'},
    {id:'09', title:'Передаточное число по угловой скорости — крен'},
    {id:'10', title:'Передаточное число по угловой скорости — тангаж'},
    {id:'11', title:'Передаточное число по скорости изменения высоты'},
    {id:'12', title:'Передаточное число по воздушной скорости'},
    {id:'13', title:'Передаточное число (угол/ход штока)'},
    {id:'14', title:'Передаточное число по КДК'},
  ];

  // 3) Реальные кандидаты для твоей структуры
  // У тебя НЕ папки 02/index.html, у тебя ФАЙЛЫ p02.html… в /vuap1/
  function candidatePaths(id){
    const p = `p${id}.html`;
    return [
      `${BASE}${p}`,        // ✅ основное: ./vuap1/p02.html
      `./vuap1/${p}`,       // дубль (на всякий)
      `./${p}`              // если вдруг файл лежит в корне (редко)
    ];
  }

  const menu   = document.getElementById('menu');
  const frame  = document.getElementById('frame');
  const titleEl= document.getElementById('title');
  const openNew= document.getElementById('openNew');
  const warn   = document.getElementById('warn');

  function build(){
    menu.innerHTML='';
    items.forEach((it, idx)=>{
      const d=document.createElement('div');
      d.className='item';
      d.dataset.idx=idx;
      const paths = candidatePaths(it.id);
      d.innerHTML =
        `<span class="num">${it.id}</span>
         <div>
           <div class="ttl">${it.title}</div>
           <div class="sub">Путь: ${paths[0]}</div>
         </div>`;
      d.onclick=()=>open(idx);
      menu.appendChild(d);
    });
  }

  function setActive(idx){
    [...menu.querySelectorAll('.item')].forEach(x=>x.classList.remove('active'));
    const el = menu.querySelector(\`.item[data-idx="\${idx}"]\`);
    if(el) el.classList.add('active');
  }

  async function exists(url){
    try{
      // IMPORTANT: для GitHub Pages GET с cache:no-store может всё равно кэшироваться,
      // но нам достаточно просто res.ok.
      const res = await fetch(url, { method:'GET' });
      return res.ok;
    }catch(e){
      return false;
    }
  }

  async function resolvePath(id){
    const list = candidatePaths(id);
    // Добавляем анти-кэш к проверке
    for(const p of list){
      const test = p + '?v=' + Date.now();
      if(await exists(test)) return test;
    }
    return null;
  }

  async function open(idx){
    const it = items[idx];
    if(!it) return;

    setActive(idx);
    titleEl.textContent = `Пункт ${it.id} · ${it.title}`;
    warn.textContent = 'Проверяю файл...';

    const url = await resolvePath(it.id);
    if(!url){
      frame.src = 'about:blank';
      const tried = candidatePaths(it.id).map(x=>`<div style="font-family:ui-monospace,monospace">${x}</div>`).join('');
      warn.innerHTML =
        `❌ <b>ФАЙЛ НЕ НАЙДЕН (404)</b><br>
         Я пробовал открыть:<br>${tried}<br>
         ✅ Проверь, что файл реально называется <b>p${it.id}.html</b> и лежит в папке <b>/vuap1/</b>.`;
      openNew.href = '#';
      return;
    }

    frame.src = url;
    openNew.href = url;
    warn.innerHTML = `✅ Открываю: <span style="font-family:ui-monospace,monospace">${url.split('?')[0]}</span>`;
  }

  function reloadFrame(){
    if(!frame.src || frame.src==='about:blank') return;
    const base = frame.src.split('?')[0];
    frame.src = base + '?v=' + Date.now();
  }

  build();

  // Автооткрытие первого пункта (можешь выключить, если не надо)
  open(0);
</script>
</body>
</html>
