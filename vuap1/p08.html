<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ВУАП-1 — Пункт 8. Проверка передаточного числа по угловой скорости</title>

  <!-- MathJax (формулы) -->
  <script>
    window.MathJax = { tex: { inlineMath: [['\\(','\\)']], displayMath: [['\\[','\\]']] } };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <style>
    :root{
      --bg:#0b0f14;
      --card:#111b23;
      --card2:#0f1720;
      --border:#243443;
      --text:#e8eef6;
      --muted:#9bb0c4;
      --good:#31d07b;
      --bad:#ff5a5a;
      --warn:#ffd166;
      --accent:#5aa9ff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:var(--bg);
      color:var(--text);
      line-height:1.35;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1180px; margin:0 auto; padding:22px 14px 70px;}
    h1{font-size:22px; margin:0 0 6px}
    .sub{color:var(--muted); font-size:13px; margin:0 0 16px}
    .toc{
      display:flex; flex-wrap:wrap; gap:8px;
      margin:10px 0 18px;
    }
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:6px 10px;
      border:1px solid var(--border);
      border-radius:999px;
      background:rgba(255,255,255,.03);
      font-size:13px;
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:14px;
      padding:14px;
      margin:12px 0;
      box-shadow:0 8px 22px rgba(0,0,0,.25);
    }
    .grid2{
      display:grid;
      grid-template-columns:1.2fr 1fr;
      gap:12px;
    }
    @media (max-width:980px){
      .grid2{grid-template-columns:1fr;}
    }
    .titleRow{
      display:flex; flex-wrap:wrap; gap:10px; align-items:baseline; justify-content:space-between;
      margin-bottom:8px;
    }
    .tag{
      display:inline-flex; align-items:center; gap:6px;
      font-size:12px; color:var(--muted);
      padding:4px 8px; border-radius:999px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.02);
    }
    ul{margin:8px 0 0 18px}
    li{margin:6px 0}
    .note{
      margin-top:10px;
      padding:10px;
      border-radius:12px;
      border:1px dashed rgba(255,209,102,.55);
      background:rgba(255,209,102,.08);
      color:#ffe7b0;
      font-size:13px;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
      font-size:13px;
      background:rgba(255,255,255,.02);
      border-radius:12px;
      overflow:hidden;
    }
    th,td{
      border:1px solid var(--border);
      padding:8px 10px;
      vertical-align:top;
    }
    th{
      background:rgba(255,255,255,.04);
      text-align:left;
    }
    .small{font-size:12px; color:var(--muted)}
    .hr{height:1px; background:rgba(255,255,255,.06); margin:12px 0}
    figure{margin:0}
    img{
      width:100%;
      border-radius:12px;
      border:1px solid var(--border);
      background:#0a0f15;
    }
    figcaption{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
    }
    .err{
      margin-top:8px;
      padding:10px;
      border-radius:12px;
      border:1px solid rgba(255,90,90,.55);
      background:rgba(255,90,90,.10);
      color:#ffd1d1;
      font-size:13px;
      display:none;
    }
    .formula{
      background:var(--card2);
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px;
      margin-top:10px;
    }
    .formGrid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:980px){
      .formGrid{grid-template-columns:1fr;}
    }
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:5px}
    input, select, button{
      width:100%;
      padding:10px 10px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#0a1118;
      color:var(--text);
      font-size:14px;
      outline:none;
    }
    input::placeholder{color:#5f7488}
    button{
      cursor:pointer;
      background:rgba(90,169,255,.12);
    }
    button:hover{background:rgba(90,169,255,.18)}
    .btnRow{
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:980px){ .btnRow{grid-template-columns:1fr;} }
    .resultBox{
      margin-top:10px;
      padding:10px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
      font-size:13px;
      white-space:pre-wrap;
    }
    .good{color:var(--good); font-weight:700}
    .bad{color:var(--bad); font-weight:700}
    .warn{color:var(--warn); font-weight:700}
    .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace}
  </style>
</head>

<body>
  <div class="wrap">
    <h1>8. Проверка передаточного числа по угловой скорости</h1>
    <p class="sub">Структура: Рисунки → Канал направления (A) → Канал крена (Б) → Канал тангажа (В) → Формулы → Калькулятор (ω и iω) + автопроверка по ТТ.</p>

    <div class="toc">
      <span class="pill"><a href="#fig">Рисунки</a></span>
      <span class="pill"><a href="#a">A. Направление</a></span>
      <span class="pill"><a href="#b">Б. Крен</a></span>
      <span class="pill"><a href="#v">В. Тангаж</a></span>
      <span class="pill"><a href="#f">Формулы</a></span>
      <span class="pill"><a href="#calc">Калькулятор</a></span>
    </div>

    <!-- Рисунки -->
    <section id="fig" class="card">
      <div class="titleRow">
        <div><b>Рисунки</b></div>
        <span class="tag">Важно: на GitHub Pages расширения/регистр чувствительны (29.JPEG ≠ 29.JPG)</span>
      </div>

      <div class="grid2">
        <figure>
          <img src="29.JPEG" alt="Рис. 6 — Крепление датчика угловых скоростей на поворотной установке"
               onerror="showImgErr('err29')">
          <figcaption>Рис. 6. Крепление датчика угловых скоростей на поворотной установке (для направления и крена). Файл: <span class="mono">vuap1/29.JPEG</span>.</figcaption>
          <div id="err29" class="err">Не загрузилось <b>29.JPEG</b>. Проверь: файл реально называется <b>29.JPEG</b> (не 29.JPG), и лежит в папке <b>vuap1</b>.</div>
        </figure>

        <figure>
          <img src="36.JPEG" alt="Рис. 7 — Крепление гировертикали на поворотной установке при проверке по угловой скорости (тангаж)"
               onerror="showImgErr('err36')">
          <figcaption>Рис. 7. Крепление гировертикали на поворотной установке при проверке передаточного числа по угловой скорости в канале тангажа. Файл: <span class="mono">vuap1/36.JPEG</span>.</figcaption>
          <div id="err36" class="err">Не загрузилось <b>36.JPEG</b>. Проверь: файл реально называется <b>36.JPEG</b> и лежит в <b>vuap1</b>.</div>
        </figure>
      </div>

      <div class="note">
        Подписи с рисунка 6 (используется и для направления, и для крена): <b>кронштейн 6С4.132.020</b>, <b>знак ⌀ на датчике сверху</b>, направление вращения: <b>правый разворот / правый крен</b>.<br>
        Подписи с рисунка 7: <b>пикирование</b>, <b>кронштейн поворотный КП-9</b>.
      </div>
    </section>

    <!-- A. Направление -->
    <section id="a" class="card">
      <div class="titleRow">
        <div><b>A. Канал направления</b></div>
        <span class="tag">В3 = “Wy” (проверка), затем В3 = “ОТКЛ.”</span>
      </div>

      <div class="grid2">
        <div class="card" style="margin:0; background:var(--card2);">
          <b>Содержание операций</b>
          <ul>
            <li>Снимите с вертолета датчик угловой скорости, установите его на установку УПГ-56 с помощью кронштейна <b>6С4.132.020</b> и с помощью переходного жгута <b>6С6.640.046-1</b> соедините датчик со схемой вертолета.</li>
            <li>Выключатель <b>В3</b> технологического жгута <b>246-9948-00</b> установите в положение <b>“Wy”</b>.</li>
            <li>Нажмите кнопку-лампочку <b>“ВКЛ.”</b> на пульте управления и поворотом шкалы ручки центровки установите подвижный индекс нулевого индикатора в среднее положение.</li>
            <li>Задайте с помощью установки вращение датчика, соответствующее правому (левому) развороту вертолета и, плавно меняя скорость вращения установки, отклоните шток малого цилиндра рулевого агрегата в положение, при котором подвижный индекс нулевого индикатора совместится с промежуточной отметкой.</li>
            <li>Заметьте направление отклонения подвижного индекса нулевого индикатора от среднего положения.</li>
            <li>Замерьте секундомером время поворота платформы установки на определенный угол и определите угловую скорость вращения, как частное от деления величины угла на время поворота установки на этот угол.</li>
            <li>Поставьте ноги на педали и произведите аналогичную проверку (<b>режим управления</b>).</li>
            <li>Установите выключатель <b>В3</b> на панели технологического жгута в положение <b>“ОТКЛ.”</b>.</li>
            <li>Проверьте работоспособность <b>изодрома</b> в цепи датчика, задав вращение платформы установки, соответствующее правому (левому) развороту.</li>
            <li>Нажмите кнопку-лампочку <b>“ОТКЛ.”</b> на пульте управления.</li>
            <li>Снимите датчик с установки и установите на вертолет.</li>
          </ul>
        </div>

        <div class="card" style="margin:0; background:var(--card2);">
          <b>Работы, выполняемые при отклонениях от ТТ</b>
          <ul>
            <li>Проверьте подсоединение датчика в схему вертолета и устраните недостаток.</li>
            <li>Отключите и вновь включите канал направления кнопками-лампочками <b>“ОТКЛ.”</b> и <b>“ВКЛ.”</b> на пульте управления.</li>
            <li>Поворотом шкалы ручки центровки установите подвижный индекс нулевого индикатора в среднее положение.</li>
            <li>Задайте вращение установке, соответствующее правому развороту, со скоростью <b>3,5 град/с</b>.</li>
            <li>Поворотом подстроечного резистора <b>“СКОР.”</b> на пульте управления добейтесь, чтобы подвижный индекс нулевого индикатора совместился с <b>левой</b> промежуточной отметкой.</li>
            <li>Измените направление вращения установки (в сторону левого разворота) и плавным изменением скорости вращения совместите подвижный индекс нулевого индикатора с <b>правой</b> промежуточной отметкой.</li>
            <li>Скорость вращения должна быть <b>(3,5 ±0,7) град/с</b>.</li>
          </ul>
          <div class="note">
            Направление отклонения индекса: при правом (левом) развороте индекс должен отклоняться <b>влево (вправо)</b>.
          </div>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th style="width:32%">Режим</th>
            <th style="width:34%">Задаваемая угловая скорость, град/с</th>
            <th>Передаточное число, % хода штока / (град/с)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><b>Основной режим</b> (по угловой скорости)</td>
            <td>(3,5 +2,1 −1,1)</td>
            <td>(20 ±8) → диапазон: <span class="mono">12…28</span></td>
          </tr>
          <tr>
            <td><b>Режим “по курсу”</b> (изодром)</td>
            <td>(6,5 +6,5 −2,0)</td>
            <td>(10 ±8) → диапазон: <span class="mono">2…18</span></td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Б. Крен -->
    <section id="b" class="card">
      <div class="titleRow">
        <div><b>Б. Канал крена</b></div>
        <span class="tag">Рис. 6 (29.JPEG) используется и тут</span>
      </div>

      <div class="grid2">
        <div class="card" style="margin:0; background:var(--card2);">
          <b>Содержание операций</b>
          <ul>
            <li>Снимите с вертолета датчик угловой скорости, установите его на установку УПГ-56 с помощью кронштейна <b>6С4.132.020</b> и с помощью переходного жгута <b>6С6.640.046-1</b> соедините датчик со схемой вертолета.</li>
            <li>Нажмите кнопку-лампочку <b>“ВКЛ.”</b> на пульте управления и поворотом шкалы ручки центровки установите подвижный индекс нулевого индикатора в среднее положение.</li>
            <li>Задайте датчику с помощью установки вращение, соответствующее правому (левому) крену и, плавно меняя скорость вращения установки, отклоните шток малого цилиндра рулевого агрегата до совмещения подвижного индекса нулевого индикатора с промежуточной отметкой.</li>
            <li>Заметьте направление отклонения подвижного индекса нулевого индикатора.</li>
            <li>Определите с помощью секундомера скорость вращения установки, соответствующую указанному положению штока.</li>
            <li>Нажмите кнопку триммера на ручке управления вертолетом летчика и проведите аналогичную проверку (<b>режим управления</b>).</li>
            <li>Нажмите кнопку-лампочку <b>“ОТКЛ.”</b> на пульте управления.</li>
          </ul>
        </div>

        <div class="card" style="margin:0; background:var(--card2);">
          <b>Работы, выполняемые при отклонениях от ТТ</b>
          <ul>
            <li>Проверьте подсоединение датчика в схему вертолета и устраните недостаток.</li>
            <li>Подрегулируйте передаточное число по методике, изложенной для канала направления (<b>резистор “СКОР.”</b> и проверка правый/левый).</li>
            <li>Скорость вращения установки должна быть в пределах <b>(8 +2,5 −1,0) град/с</b>.</li>
          </ul>

          <div class="note">
            Направление отклонения индекса: при правом (левом) крене индекс должен отклоняться <b>влево (вправо)</b>.
          </div>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th style="width:32%">Режим</th>
            <th style="width:34%">Задаваемая угловая скорость, град/с</th>
            <th>Передаточное число, % хода штока / (град/с)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><b>Основной режим</b> (по угловой скорости)</td>
            <td>(8 +6 −2)</td>
            <td>(8 ±3,2) → диапазон: <span class="mono">4,8…11,2</span></td>
          </tr>
          <tr>
            <td><b>Режим управления</b> (при нажатии кнопки триммера)</td>
            <td>(17 +16,5 −6)</td>
            <td>(4 ±2) → диапазон: <span class="mono">2…6</span></td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- В. Тангаж -->
    <section id="v" class="card">
      <div class="titleRow">
        <div><b>В. Канал тангажа</b> (пикирование/кабрирование)</div>
        <span class="tag">В2 = “Wz”, Рис. 7 = 36.JPEG, ограничение ±30°</span>
      </div>

      <div class="grid2">
        <div class="card" style="margin:0; background:var(--card2);">
          <b>Содержание операций</b>
          <ul>
            <li>Снимите с вертолета левую гировертикаль, установите ее на поворотную установку УПГ-56 с помощью кронштейна <b>КП-9</b> и с помощью переходного жгута <b>6С4.863.467-1</b> соедините со схемой вертолета.</li>
            <li>Установите выключатель <b>В2</b> на панели технологического жгута в положение <b>“Wz”</b>.</li>
            <li>Нажмите кнопку-лампочку <b>“ВКЛ.”</b> на пульте управления и поворотом потенциометра <b>“ЦЕНТР”</b> установите подвижный индекс нулевого индикатора в среднее положение.</li>
            <li>Проверьте передаточное число по методике, аналогичной для каналов направления и крена.</li>
            <li>Установите выключатель <b>В2</b> на панели технологического жгута в положение <b>“ОТКЛ.”</b>.</li>
            <li>Нажмите кнопку-лампочку <b>“ОТКЛ.”</b> на пульте управления.</li>
          </ul>
        </div>

        <div class="card" style="margin:0; background:var(--card2);">
          <b>Работы, выполняемые при отклонениях от ТТ</b>
          <ul>
            <li>Отключите и вновь включите канал тангажа кнопками-лампочками <b>“ОТКЛ.”</b> и <b>“ВКЛ.”</b> на пульте управления.</li>
            <li>Потенциометром <b>“ЦЕНТР”</b> установите подвижный индекс нулевого индикатора в среднее положение.</li>
            <li>Задайте вращение установке, соответствующее пикированию, со скоростью <b>3,5 град/с</b>.</li>
            <li>Поворотом потенциометра <b>“СКОР.”</b> на пульте управления совместите подвижный индекс с <b>верхней</b> промежуточной отметкой.</li>
            <li>Измените направление вращения установки в сторону кабрирования и плавным изменением скорости вращения совместите подвижный индекс нулевого индикатора с <b>нижней</b> промежуточной отметкой.</li>
            <li>Скорость вращения установки должна быть в пределах <b>(3,5 ±0,7) град/с</b>.</li>
            <li>Установите подвижный индекс нулевого индикатора в среднее положение с помощью потенциометра <b>“ЦЕНТР”</b> на пульте управления.</li>
          </ul>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th style="width:34%">Параметр</th>
            <th>Технические требования (ТТ)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Направление отклонения</td>
            <td>При вращении гировертикали на <b>пикирование</b> (кабрирование) подвижный индекс нулевого индикатора должен отклоняться <b>вверх</b> (<b>вниз</b>).</td>
          </tr>
          <tr>
            <td>Задаваемая угловая скорость</td>
            <td>(3,5 +2,1 −1,1) град/с</td>
          </tr>
          <tr>
            <td>Передаточное число</td>
            <td>(20 ±8) % хода штока / (град/с) → диапазон: <span class="mono">12…28</span></td>
          </tr>
          <tr>
            <td>Ограничение по углу отклонения гировертикали</td>
            <td>Угол отклонения от нулевого положения не должен превышать <b>±30°</b> (при больших углах крутизна сигнала уменьшается).</td>
          </tr>
          <tr>
            <td>Рисунок</td>
            <td>Рис. 7 = <span class="mono">36.JPEG</span></td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Формулы -->
    <section id="f" class="card">
      <div class="titleRow">
        <div><b>Формулы</b></div>
        <span class="tag">Используется в калькуляторе</span>
      </div>

      <div class="formula">
        <div><b>1) Определение угловой скорости вращения</b></div>
        <div class="small">где Δφ — угол поворота платформы (град), t — время (с), ω — угловая скорость (град/с)</div>
        <div style="margin-top:8px">\[
          \omega=\frac{\Delta\varphi}{t}
        \]</div>
      </div>

      <div class="formula">
        <div><b>2) Передаточное число по угловой скорости</b></div>
        <div class="small">где S — % хода штока малого цилиндра, ω — угловая скорость (град/с), iω — %/(град/с)</div>
        <div style="margin-top:8px">\[
          i_{\omega}=\frac{S}{\omega}
        \]</div>
      </div>

      <div class="note">
        Для автопроверки по ТТ калькулятор сравнивает iω с допустимым диапазоном (например 20±8 → 12…28).
      </div>
    </section>

    <!-- Калькулятор -->
    <section id="calc" class="card">
      <div class="titleRow">
        <div><b>Калькулятор (ω и iω) + автоматическая проверка по ТТ</b></div>
        <span class="tag">Считает ω=Δφ/t и iω=S/ω</span>
      </div>

      <div class="formGrid">
        <div>
          <label>Выбор режима ТТ</label>
          <select id="mode">
            <option value="yaw_main">Направление — основной режим (ω≈3,5), iω = 20±8</option>
            <option value="yaw_course">Направление — по курсу / изодром (ω≈6,5), iω = 10±8</option>
            <option value="roll_main">Крен — основной режим (ω≈8), iω = 8±3,2</option>
            <option value="roll_ctrl">Крен — режим управления (кнопка триммера, ω≈17), iω = 4±2</option>
            <option value="pitch">Тангаж — (ω≈3,5), iω = 20±8</option>
          </select>
        </div>

        <div>
          <label>Подсказка по направлению отклонения индекса (только для контроля логики)</label>
          <select id="dir">
            <option value="none">Не проверяю направление</option>
            <option value="yaw">Направление: правый→влево, левый→вправо</option>
            <option value="roll">Крен: правый→влево, левый→вправо</option>
            <option value="pitch">Тангаж: пикирование→вверх, кабрирование→вниз</option>
          </select>
        </div>
      </div>

      <div class="formGrid">
        <div class="card" style="margin:0; background:var(--card2);">
          <b>Шаг 1 — посчитать ω</b>
          <div class="formGrid" style="grid-template-columns:1fr 1fr;">
            <div>
              <label>Δφ, угол поворота платформы (град)</label>
              <input id="phi" type="number" step="0.01" placeholder="например 90" />
            </div>
            <div>
              <label>t, время поворота (сек)</label>
              <input id="t" type="number" step="0.01" placeholder="например 18" />
            </div>
          </div>
          <div class="small" style="margin-top:6px">ω будет рассчитана как Δφ/t. Можно не вводить — тогда ω введёшь вручную ниже.</div>
        </div>

        <div class="card" style="margin:0; background:var(--card2);">
          <b>Шаг 2 — посчитать iω</b>
          <div class="formGrid" style="grid-template-columns:1fr 1fr;">
            <div>
              <label>S, % хода штока (в момент совмещения с отметкой)</label>
              <input id="S" type="number" step="0.01" placeholder="например 66.7" />
            </div>
            <div>
              <label>ω, угловая скорость (град/с) — если не считаешь через Δφ/t</label>
              <input id="omega" type="number" step="0.01" placeholder="например 3.5" />
            </div>
          </div>
          <div class="small" style="margin-top:6px">Если заполнены Δφ и t — ω подставится автоматически (кнопка ниже).</div>
        </div>
      </div>

      <div class="btnRow">
        <button onclick="calcOmega()">Посчитать ω = Δφ / t</button>
        <button onclick="calcIw()">Посчитать iω = S / ω + проверка по ТТ</button>
        <button onclick="clearAll()">Очистить</button>
      </div>

      <div id="out" class="resultBox">Готово.</div>
    </section>

  </div>

  <script>
    function showImgErr(id){
      const el = document.getElementById(id);
      if(el) el.style.display = 'block';
    }

    const TT = {
      yaw_main:  { name:'Направление — основной', iw_min:12,  iw_max:28, omega_hint:'(3,5 +2,1 −1,1)'},
      yaw_course:{ name:'Направление — по курсу/изодром', iw_min:2, iw_max:18, omega_hint:'(6,5 +6,5 −2,0)'},
      roll_main: { name:'Крен — основной', iw_min:4.8, iw_max:11.2, omega_hint:'(8 +6 −2)'},
      roll_ctrl: { name:'Крен — режим управления (триммер)', iw_min:2, iw_max:6, omega_hint:'(17 +16,5 −6)'},
      pitch:     { name:'Тангаж', iw_min:12, iw_max:28, omega_hint:'(3,5 +2,1 −1,1)'}
    };

    function num(id){
      const v = document.getElementById(id).value;
      if(v === '' || v === null || v === undefined) return null;
      const n = Number(v);
      return Number.isFinite(n) ? n : null;
    }

    function setOut(text){
      document.getElementById('out').textContent = text;
    }

    function calcOmega(){
      const phi = num('phi');
      const t = num('t');
      if(phi === null || t === null || t === 0){
        setOut('Ошибка: введи Δφ и t (t ≠ 0).');
        return;
      }
      const omega = phi / t;
      document.getElementById('omega').value = omega.toFixed(3);
      setOut(`ω = Δφ/t = ${phi} / ${t} = ${omega.toFixed(3)} град/с`);
    }

    function calcIw(){
      const modeKey = document.getElementById('mode').value;
      const tt = TT[modeKey];

      let omega = num('omega');
      const phi = num('phi');
      const t = num('t');

      // если ω не введена, но есть Δφ и t — считаем автоматически
      if(omega === null && phi !== null && t !== null && t !== 0){
        omega = phi / t;
        document.getElementById('omega').value = omega.toFixed(3);
      }

      const S = num('S');
      if(S === null || omega === null || omega === 0){
        setOut('Ошибка: нужен S (% хода штока) и ω (град/с). Можно посчитать ω кнопкой "Посчитать ω".');
        return;
      }

      const iw = S / omega;

      const ok = (iw >= tt.iw_min && iw <= tt.iw_max);

      const status = ok ? 'PASS' : 'FAIL';
      const statusColor = ok ? 'good' : 'bad';

      const dirMode = document.getElementById('dir').value;
      let dirHint = '';
      if(dirMode === 'yaw'){
        dirHint = 'Контроль направления: правый→влево, левый→вправо (канал направления).';
      } else if(dirMode === 'roll'){
        dirHint = 'Контроль направления: правый крен→влево, левый крен→вправо (канал крена).';
      } else if(dirMode === 'pitch'){
        dirHint = 'Контроль направления: пикирование→вверх, кабрирование→вниз (канал тангажа).';
      }

      const txt =
`${tt.name}
Подсказка по ω из ТТ: ${tt.omega_hint} град/с

Ввод:
S = ${S} % хода штока
ω = ${omega.toFixed(3)} град/с

Расчёт:
iω = S/ω = ${S} / ${omega.toFixed(3)} = ${iw.toFixed(3)} %/(град/с)

ТТ диапазон iω: ${tt.iw_min} … ${tt.iw_max} %/(град/с)
ИТОГ: ${status} (${ok ? 'в пределах ТТ' : 'НЕ в пределах ТТ'})

${dirHint ? ('\n' + dirHint) : ''}`;

      // подсветку делаем простым трюком: добавим строку внизу с меткой, а цвет — через HTML нельзя (тут textContent).
      // Поэтому оставим текст, а если хочешь — скажешь, сделаю HTML-вывод с цветами.
      setOut(txt);
    }

    function clearAll(){
      ['phi','t','S','omega'].forEach(id => document.getElementById(id).value = '');
      document.getElementById('mode').value = 'yaw_main';
      document.getElementById('dir').value = 'none';
      setOut('Очищено.');
    }
  </script>
</body>
</html>
