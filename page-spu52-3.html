<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>СПУ-52-3 — расчёт передаточных чисел</title>

<!-- Math rendering -->
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

<style>
:root{
  --blue:#0057b7;
  --yellow:#ffd700;
  --glass:rgba(255,255,255,0.18);
  --border:rgba(255,255,255,0.35);
  --ok:#27ae60;
  --bad:#e74c3c;
}

*{box-sizing:border-box;font-family:Inter,Segoe UI,Arial,sans-serif}
body{
  margin:0;
  min-height:100vh;
  background:
    linear-gradient(180deg,var(--blue) 0%,var(--blue) 45%,var(--yellow) 55%,var(--yellow) 100%);
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding:40px;
  color:#fff;
}

.container{
  width:100%;
  max-width:1200px;
}

h1{
  margin:0 0 20px;
  font-weight:700;
  letter-spacing:.4px;
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:24px;
}

.card{
  background:var(--glass);
  backdrop-filter:blur(16px);
  border:1px solid var(--border);
  border-radius:18px;
  padding:22px;
  box-shadow:0 20px 40px rgba(0,0,0,.25);
}

.card h2{
  margin:0 0 16px;
  font-size:18px;
}

.field{
  margin-bottom:12px;
}
.field label{
  display:block;
  font-size:13px;
  opacity:.85;
  margin-bottom:4px;
}
.field input{
  width:100%;
  padding:10px 12px;
  border-radius:10px;
  border:none;
  outline:none;
  font-size:15px;
}

.result{
  margin-top:14px;
  padding:12px;
  border-radius:12px;
  background:rgba(0,0,0,.25);
}

.formula{
  margin-top:10px;
  padding:10px;
  background:rgba(0,0,0,.2);
  border-radius:10px;
}

.status{
  margin-top:12px;
  padding:10px;
  border-radius:12px;
  font-weight:600;
  text-align:center;
}

.ok{background:rgba(39,174,96,.85)}
.bad{background:rgba(231,76,60,.85)}

.small{
  font-size:13px;
  opacity:.85;
  margin-top:6px;
}

@media(max-width:900px){
  .grid{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="container">
<h1>СПУ-52-3 — расчёт передаточных чисел</h1>

<div class="grid">

<!-- PRESSURE -->
<div class="card">
<h2>Давление (по высоте)</h2>

<div class="field">
<label>P(1000), мм рт.ст.</label>
<input id="p1000" value="674.115">
</div>

<div class="field">
<label>H, м</label>
<input id="h" value="2430">
</div>

<div class="result" id="pRes"></div>
<div class="formula" id="pFormula"></div>
<div class="status" id="pStatus"></div>
</div>

<!-- TEMPERATURE -->
<div class="card">
<h2>Температура</h2>

<div class="field">
<label>R1, Ом</label>
<input id="r1" value="98.6">
</div>

<div class="field">
<label>R2, Ом</label>
<input id="r2" value="105">
</div>

<div class="result" id="tRes"></div>
<div class="formula" id="tFormula"></div>
<div class="status" id="tStatus"></div>

<div class="small">Норма: i<sub>T</sub> = 0.85 ± 0.17</div>
</div>

</div>
</div>

<script>
// ===== TABLES (REGULATED, STATIC) =====
const pressureTable = [
 {h:1000,p:674.115},{h:2000,p:596.263},{h:3000,p:525.857}
];

const tempTable = [
 {r:76.86,t:-40},{r:83.16,t:-30},{r:90.26,t:-20},{r:97.36,t:-10},
 {r:104.86, t:0},{r:112.78,t:10},{r:121.22,t:20}
];

// ===== HELPERS =====
function interp(x,a,b,xa,xb){
 return a+(x-xa)*(b-a)/(xb-xa);
}
function TfromR(R){
 for(let i=0;i<tempTable.length-1;i++){
  let A=tempTable[i],B=tempTable[i+1];
  if(R>=A.r && R<=B.r)
   return interp(R,A.t,B.t,A.r,B.r);
 }
 return null;
}

// ===== PRESSURE CALC =====
function calcPressure(){
 let P1000=+p1000.value,H=+h.value;
 let Ptab=interp(H,674.115,565.117,1000,2430);
 let dP=P1000-Ptab;
 let ip=33.3/dP;

 pRes.innerHTML=`ΔP = ${dP.toFixed(3)} мм<br>i<sub>P</sub> = ${ip.toFixed(3)}`;
 katex.render("\\displaystyle i_P=\\frac{33.3}{\\Delta P}",pFormula);

 pStatus.className="status "+(ip>=0.26&&ip<=0.38?"ok":"bad");
 pStatus.innerText=ip>=0.26&&ip<=0.38?"НОРМА":"НЕ НОРМА";
}

// ===== TEMP CALC =====
function calcTemp(){
 let R1=+r1.value,R2=+r2.value;
 let T1=TfromR(R1),T2=TfromR(R2);
 let dT1=T1-7,dT2=T2-7;
 let iT=33.3/Math.abs(dT2);

 tRes.innerHTML=
 `T1=${T1.toFixed(2)} °C<br>T2=${T2.toFixed(2)} °C<br>i<sub>T</sub>=${iT.toFixed(3)}`;

 katex.render("\\displaystyle i_T=\\frac{33.3}{\\Delta T}",tFormula);

 tStatus.className="status "+(iT>=0.68&&iT<=1.02?"ok":"bad");
 tStatus.innerText=iT>=0.68&&iT<=1.02?"НОРМА":"НЕ НОРМА";
}

// LIVE
[p1000,h].forEach(e=>e.oninput=calcPressure);
[r1,r2].forEach(e=>e.oninput=calcTemp);

calcPressure();
calcTemp();
</script>
</body>
</html>
